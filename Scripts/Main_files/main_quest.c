#include <stdio.h>
#include <math.h>
#include <stdlib.h>
#include <string.h>
#include <stdbool.h>
#include <time.h>

#include "UIS_Est_1.h"
#include "UIS_Est_2.h" 
#include "UIS_Est_3.h" 
#include "UIS_Est_4.h" 
#include "UIS_Est_5.h" 
#include "UIS_Est_6.h" 
#include "UIS_Est_7.h" 
#include "UIS_Est_8.h" 
#include "UIS_Est_9.h" 
#include "UIS_Est_10.h"
#include "UIS_Est_11.h"
#include "UIS_Est_12.h"
#include "UIS_Est_13.h"
#include "UIS_Est_14.h"
#include "UIS_Est_15.h"
#include "UIS_Est_16.h"
#include "UIS_Est_17.h"
#include "UIS_Est_18.h"
#include "UIS_Est_19.h"
#include "UIS_Est_20.h"
#include "UIS_Est_21.h"
#include "UIS_Est_22.h"
#include "UIS_Est_23.h"
#include "UIS_Est_24.h"
#include "UIS_Est_25.h"
#include "UIS_Est_26.h"
#include "UIS_Est_27.h"
#include "UIS_Est_28.h"
#include "UIS_Est_29.h"
#include "UIS_Est_30.h"
#include "UIS_Est_31.h"
#include "UIS_Est_32.h"
#include "UIS_Est_33.h"
#include "UIS_Est_34.h"
#include "UIS_Est_35.h"
#include "UIS_Est_36.h"
#include "UIS_Est_37.h"
#include "UIS_Est_38.h"
#include "UIS_Est_39.h"
#include "UIS_Est_40.h"
#include "UIS_Est_41.h"
#include "UIS_Est_42.h"
#include "UIS_Est_43.h"
#include "UIS_Est_44.h"
#include "UIS_Est_45.h"
#include "UIS_Est_46.h"
#include "UIS_Est_47.h"
#include "UIS_Est_48.h"
#include "UIS_Est_49.h"
#include "UIS_Est_50.h"
#include "UIS_Est_51.h"
#include "UIS_Est_52.h"
#include "UIS_Est_53.h"
#include "UIS_Est_54.h"
#include "UIS_Est_55.h"
#include "UIS_Est_56.h"
#include "UIS_Est_57.h"
#include "UIS_Est_58.h"
#include "UIS_Est_59.h"
#include "UIS_Est_60.h"
#include "UIS_Est_61.h"
#include "UIS_Est_62.h"
#include "UIS_Est_63.h"
#include "UIS_Est_64.h"
#include "UIS_Est_65.h"
#include "UIS_Est_66.h"
#include "UIS_Est_67.h"
#include "UIS_Est_68.h"
#include "UIS_Est_69.h"
#include "UIS_Est_70.h"
#include "UIS_Est_71.h"
#include "UIS_Est_72.h"
#include "UIS_Est_73.h"
#include "UIS_Est_74.h"
#include "UIS_Est_75.h"
#include "UIS_Est_76.h"
#include "UIS_Est_77.h"
#include "UIS_Est_78.h"
#include "UIS_Est_79.h"
#include "UIS_Est_80.h"
#include "UIS_Est_81.h"
#include "UIS_Est_82.h"
#include "UIS_Est_83.h"
#include "UIS_Est_84.h"
#include "UIS_Est_85.h"
#include "UIS_Est_86.h"
#include "UIS_Est_87.h"
#include "UIS_Est_88.h"
#include "UIS_Est_89.h"
#include "UIS_Est_90.h"
#include "UIS_Est_91.h"
#include "UIS_Est_92.h"
#include "UIS_Est_93.h"
#include "UIS_Est_94.h"
#include "UIS_Est_95.h"
#include "UIS_Est_96.h"
#include "UIS_Est_97.h"
#include "UIS_Est_98.h"
#include "UIS_Est_99.h"
#include "UIS_Est_100.h"

#include "functions.h"

void UIS_N_i(int tot_stars_UIS[100])
{
    tot_stars_UIS[0] = N_i_1;
    tot_stars_UIS[1] = N_i_2;
    tot_stars_UIS[2] = N_i_3;
    tot_stars_UIS[3] = N_i_4;
    tot_stars_UIS[4] = N_i_5;
    tot_stars_UIS[5] = N_i_6;
    tot_stars_UIS[6] = N_i_7;
    tot_stars_UIS[7] = N_i_8;
    tot_stars_UIS[8] = N_i_9;
    tot_stars_UIS[9] = N_i_10;
    tot_stars_UIS[10] = N_i_11;
    tot_stars_UIS[11] = N_i_12;
    tot_stars_UIS[12] = N_i_13;
    tot_stars_UIS[13] = N_i_14;
    tot_stars_UIS[14] = N_i_15;
    tot_stars_UIS[15] = N_i_16;
    tot_stars_UIS[16] = N_i_17;
    tot_stars_UIS[17] = N_i_18;
    tot_stars_UIS[18] = N_i_19;
    tot_stars_UIS[19] = N_i_20;
    tot_stars_UIS[20] = N_i_21;
    tot_stars_UIS[21] = N_i_22;
    tot_stars_UIS[22] = N_i_23;
    tot_stars_UIS[23] = N_i_24;
    tot_stars_UIS[24] = N_i_25;
    tot_stars_UIS[25] = N_i_26;
    tot_stars_UIS[26] = N_i_27;
    tot_stars_UIS[27] = N_i_28;
    tot_stars_UIS[28] = N_i_29;
    tot_stars_UIS[29] = N_i_30;
    tot_stars_UIS[30] = N_i_31;
    tot_stars_UIS[31] = N_i_32;
    tot_stars_UIS[32] = N_i_33;
    tot_stars_UIS[33] = N_i_34;
    tot_stars_UIS[34] = N_i_35;
    tot_stars_UIS[35] = N_i_36;
    tot_stars_UIS[36] = N_i_37;
    tot_stars_UIS[37] = N_i_38;
    tot_stars_UIS[38] = N_i_39;
    tot_stars_UIS[39] = N_i_40;
    tot_stars_UIS[40] = N_i_41;
    tot_stars_UIS[41] = N_i_42;
    tot_stars_UIS[42] = N_i_43;
    tot_stars_UIS[43] = N_i_44;
    tot_stars_UIS[44] = N_i_45;
    tot_stars_UIS[45] = N_i_46;
    tot_stars_UIS[46] = N_i_47;
    tot_stars_UIS[47] = N_i_48;
    tot_stars_UIS[48] = N_i_49;
    tot_stars_UIS[49] = N_i_50;
    tot_stars_UIS[50] = N_i_51;
    tot_stars_UIS[51] = N_i_52;
    tot_stars_UIS[52] = N_i_53;
    tot_stars_UIS[53] = N_i_54;
    tot_stars_UIS[54] = N_i_55;
    tot_stars_UIS[55] = N_i_56;
    tot_stars_UIS[56] = N_i_57;
    tot_stars_UIS[57] = N_i_58;
    tot_stars_UIS[58] = N_i_59;
    tot_stars_UIS[59] = N_i_60;
    tot_stars_UIS[60] = N_i_61;
    tot_stars_UIS[61] = N_i_62;
    tot_stars_UIS[62] = N_i_63;
    tot_stars_UIS[63] = N_i_64;
    tot_stars_UIS[64] = N_i_65;
    tot_stars_UIS[65] = N_i_66;
    tot_stars_UIS[66] = N_i_67;
    tot_stars_UIS[67] = N_i_68;
    tot_stars_UIS[68] = N_i_69;
    tot_stars_UIS[69] = N_i_70;
    tot_stars_UIS[70] = N_i_71;
    tot_stars_UIS[71] = N_i_72;
    tot_stars_UIS[72] = N_i_73;
    tot_stars_UIS[73] = N_i_74;
    tot_stars_UIS[74] = N_i_75;
    tot_stars_UIS[75] = N_i_76;
    tot_stars_UIS[76] = N_i_77;
    tot_stars_UIS[77] = N_i_78;
    tot_stars_UIS[78] = N_i_79;
    tot_stars_UIS[79] = N_i_80;
    tot_stars_UIS[80] = N_i_81;
    tot_stars_UIS[81] = N_i_82;
    tot_stars_UIS[82] = N_i_83;
    tot_stars_UIS[83] = N_i_84;
    tot_stars_UIS[84] = N_i_85;
    tot_stars_UIS[85] = N_i_86;
    tot_stars_UIS[86] = N_i_87;
    tot_stars_UIS[87] = N_i_88;
    tot_stars_UIS[88] = N_i_89;
    tot_stars_UIS[89] = N_i_90;
    tot_stars_UIS[90] = N_i_91;
    tot_stars_UIS[91] = N_i_92;
    tot_stars_UIS[92] = N_i_93;
    tot_stars_UIS[93] = N_i_94;
    tot_stars_UIS[94] = N_i_95;
    tot_stars_UIS[95] = N_i_96;
    tot_stars_UIS[96] = N_i_97;
    tot_stars_UIS[97] = N_i_98;
    tot_stars_UIS[98] = N_i_99;
    tot_stars_UIS[99] = N_i_100;

}

double (*UIS_Est_frames[100]) [50] = 
{UIS_Est_1, UIS_Est_2, UIS_Est_3, UIS_Est_4, UIS_Est_5, UIS_Est_6, UIS_Est_7, UIS_Est_8, UIS_Est_9, UIS_Est_10,
 UIS_Est_11, UIS_Est_12, UIS_Est_13, UIS_Est_14, UIS_Est_15, UIS_Est_16, UIS_Est_17, UIS_Est_18, UIS_Est_19,UIS_Est_20,
 UIS_Est_21, UIS_Est_22, UIS_Est_23, UIS_Est_24, UIS_Est_25, UIS_Est_26, UIS_Est_27, UIS_Est_28, UIS_Est_29, UIS_Est_30,
 UIS_Est_31, UIS_Est_32, UIS_Est_33, UIS_Est_34, UIS_Est_35, UIS_Est_36, UIS_Est_37, UIS_Est_38, UIS_Est_39, UIS_Est_40,
 UIS_Est_41, UIS_Est_42, UIS_Est_43, UIS_Est_44, UIS_Est_45, UIS_Est_46, UIS_Est_47, UIS_Est_48, UIS_Est_49, UIS_Est_50, 
 UIS_Est_51, UIS_Est_52, UIS_Est_53, UIS_Est_54, UIS_Est_55, UIS_Est_56, UIS_Est_57, UIS_Est_58, UIS_Est_59, UIS_Est_60,
 UIS_Est_61, UIS_Est_62, UIS_Est_63, UIS_Est_64, UIS_Est_65, UIS_Est_66, UIS_Est_67, UIS_Est_68, UIS_Est_69, UIS_Est_70,
 UIS_Est_71, UIS_Est_72, UIS_Est_73, UIS_Est_74, UIS_Est_75, UIS_Est_76, UIS_Est_77, UIS_Est_78, UIS_Est_79, UIS_Est_80, 
 UIS_Est_81, UIS_Est_82, UIS_Est_83, UIS_Est_84, UIS_Est_85, UIS_Est_86, UIS_Est_87, UIS_Est_88, UIS_Est_89, UIS_Est_90, 
 UIS_Est_91, UIS_Est_92, UIS_Est_93, UIS_Est_94, UIS_Est_95, UIS_Est_96, UIS_Est_97, UIS_Est_98, UIS_Est_99, UIS_Est_100,};

int main()
{
    clock_t start, end;
    start = clock();

    int UIS_tot_stars[100];
    UIS_N_i(UIS_tot_stars);

    int frame = 0;
    int tot_stars = UIS_tot_stars[frame];

    while(frame < 100)
    {
        tot_stars = UIS_tot_stars[frame];
        printf("UIS_iter_%d\n", frame + 1);
        double out[4];

        // Perform QUEST
        if(tot_stars != 0)
        {
            quest(out, UIS_Est_frames[frame], tot_stars);
            frame++;

            // Printing the quaternion values on the terminal
            printf("\n");
            printf("quat_3.x = %.15f\n", out[0]);
            printf("quat_3.y = %.15f\n", out[1]);
            printf("quat_3.z = %.15f\n", out[2]);
            printf("quat_4   = %.15f\n\n\n", out[3]);
        }
        else
        {
            frame ++;
            printf("\n");
            printf("quat_3.x = -1\n");
            printf("quat_3.y = -1\n");
            printf("quat_3.z = -1\n");
            printf("quat_4   = -1\n\n\n");
        }
    }

    end = clock();
    double duration = ((double)end - start)/CLOCKS_PER_SEC;
    printf("Time taken to execute in seconds : %f", duration);
}