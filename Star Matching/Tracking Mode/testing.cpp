#include <stdio.h>
#include <stdlib.h>
#include <math.h>
#include "sm_TM_consts.h"
#include "sm_TM_CP.h"
#include "sm_TM_RBM.h" //Remove this to test only CP

#include <iostream>
using namespace std;

int main()
{//return 0;}
int N = 62;

double prev1[62][3] = {0 , 0 , 200 ,
-655 , 42 , 4946 ,
68 , 31 , 738 ,
3 , 29 , 1584 ,
-53 , 28 , 3100 ,
32 , 28 , 3322 ,
-21 , 40 , 2995 ,
-263 , 63 , 1736 ,
-6 , 34 , 1361 ,
153 , 56 , 2451 ,
-24 , 30 , 1891 ,
63 , 28 , 4147 ,
-16 , 36 , 4624 ,
86 , 37 , 3554 ,
21 , 34 , 4999 ,
-15 , 29 , 1646 ,
126 , 36 , 196 ,
73 , 28 , 3477 ,
-8 , 51 , 360 ,
126 , 29 , 4229 ,
40 , 29 , 3923 ,
-104 , 30 , 3691 ,
79 , 28 , 4943 ,
688 , 35 , 2470 ,
31 , 40 , 262 ,
-14 , 28 , 818 ,
-27 , 28 , 802 ,
23 , 29 , 2821 ,
83 , 35 , 2554 ,
-15 , 29 , 2079 ,
-159 , 40 , 3063 ,
-64 , 29 , 2824 ,
136 , 38 , 2927 ,
2 , 30 , 1318 ,
-95 , 29 , 1442 ,
-8 , 28 , 415 ,
45 , 28 , 2996 ,
-30 , 28 , 635 ,
-172 , 31 , 2860 ,
-49 , 29 , 3445 ,
52 , 29 , 141 ,
6 , 31 , 3689 ,
-25 , 30 , 432 ,
50 , 55 , 1996 ,
-9 , 33 , 3507 ,
36 , 28 , 4625 ,
50 , 42 , 2395 ,
1495 , 4887 , 282 ,
6 , 28 , 478 ,
78 , 32 , 3327 ,
2 , 31 , 3733 ,
-224 , 29 , 2523 ,
42 , 28 , 2255 ,
168 , 34 , 1755 ,
153 , 29 , 1292 ,
-31 , 32 , 3061 ,
-557 , 77 , 4730 ,
41 , 30 , 4887 ,
1 , 29 , 922 ,
-80 , 28 , 2559 ,
-28 , 28 , 2578 ,
-96 , 31 , 1047
}; //COPY-PASTE FROM TESTCASE.PY


double prev2[62][3] = {0 , 0 , 200 ,
-1540 , 101 , 4946 ,
61 , 28 , 738 ,
3 , 30 , 1584 ,
-60 , 32 , 3100 ,
31 , 27 , 3322 ,
-23 , 43 , 2995 ,
-418 , 101 , 1736 ,
-6 , 36 , 1361 ,
115 , 42 , 2451 ,
-26 , 32 , 1891 ,
57 , 25 , 4147 ,
-17 , 38 , 4624 ,
74 , 32 , 3554 ,
21 , 34 , 4999 ,
-16 , 31 , 1646 ,
99 , 28 , 196 ,
64 , 24 , 3477 ,
-8 , 54 , 360 ,
98 , 22 , 4229 ,
38 , 27 , 3923 ,
-129 , 37 , 3691 ,
69 , 24 , 4943 ,
-235 , -14 , 2470 ,
30 , 39 , 262 ,
-15 , 30 , 818 ,
-29 , 30 , 802 ,
23 , 28 , 2821 ,
72 , 30 , 2554 ,
-16 , 31 , 2079 ,
-216 , 55 , 3063 ,
-74 , 34 , 2824 ,
104 , 29 , 2927 ,
2 , 31 , 1318 ,
-116 , 36 , 1442 ,
-8 , 29 , 415 ,
42 , 26 , 2996 ,
-33 , 31 , 635 ,
-236 , 43 , 2860 ,
-55 , 33 , 3445 ,
48 , 27 , 141 ,
6 , 32 , 3689 ,
-27 , 32 , 432 ,
48 , 52 , 1996 ,
-9 , 35 , 3507 ,
34 , 27 , 4625 ,
47 , 39 , 2395 ,
4346 , 14153 , 282 ,
6 , 28 , 478 ,
68 , 28 , 3327 ,
2 , 32 , 3733 ,
-331 , 44 , 2523 ,
40 , 26 , 2255 ,
117 , 23 , 1755 ,
111 , 21 , 1292 ,
-34 , 35 , 3061 ,
-1220 , 170 , 4730 ,
39 , 28 , 4887 ,
1 , 30 , 922 ,
-95 , 34 , 2559 ,
-30 , 30 , 2578 ,
-117 , 38 , 1047  }; //COPY-PASTE FROM TESTCASE.PY


double pred[62][3];
sm_TM_CP(prev1, prev2, FOCAL_LENGTH, pred, N, pixel_size);

//TO CHECK CP OUTPUT--------------------
/*for (int i=0; i<N; i++)
    cout<<pred[i][0]<<' '<<pred[i][1]<<' '<<pred[i][2]<<endl;
*/


//TO CHECK CP + RBM OUTPUT---------------
double truemat[62][2] = {0 , 0 ,
-6438 , 427 ,
55 , 25 ,
3 , 31 ,
-69 , 37 ,
30 , 26 ,
-25 , 47 ,
-809 , 197 ,
-6 , 38 ,
94 , 34 ,
-28 , 35 ,
52 , 23 ,
-18 , 41 ,
66 , 28 ,
21 , 34 ,
-17 , 33 ,
82 , 23 ,
57 , 21 ,
-8 , 58 ,
81 , 18 ,
36 , 26 ,
-167 , 48 ,
61 , 21 ,
-342 , -20 ,
29 , 38 ,
-16 , 32 ,
-31 , 33 ,
23 , 27 ,
64 , 26 ,
-17 , 33 ,
-321 , 82 ,
-87 , 40 ,
85 , 23 ,
2 , 32 ,
-147 , 46 ,
-8 , 30 ,
40 , 24 ,
-36 , 34 ,
-357 , 66 ,
-63 , 38 ,
45 , 25 ,
6 , 33 ,
-29 , 35 ,
46 , 50 ,
-9 , 37 ,
33 , 26 ,
45 , 37 ,
28122 , 91429 ,
6 , 28 ,
61 , 25 ,
2 , 33 ,
-565 , 76 ,
38 , 24 ,
92 , 18 ,
89 , 16 ,
-37 , 39 ,
-4404 , 617 ,
37 , 26 ,
1 , 31 ,
-116 , 42 ,
-33 , 33 ,
-149 , 49
}; //COPY-PASTE FROM TESTCASE.PY
double matchmat[62][5];
int good = 0;
good = sm_TM_RBM(pred, N, truemat, N, 15, true, true, matchmat);

for (int i=0; i<N; i++)
    cout<<matchmat[i][0]<<' '<<matchmat[i][1]<<' '<<matchmat[i][2]<<' '<<matchmat[i][3]<<' '<<matchmat[i][4]<<' '<<endl;

cout<<endl<<endl<<good<<endl;
}
